# マルチプレイヤーテスト計画

## テスト環境

### 必要な環境
- 複数のブラウザウィンドウ（Chrome、Firefox、Safari）
- Devvitプレイテスト環境
- 複数のRedditアカウント（オプション）

### テスト準備
```bash
# 開発サーバーを起動
npm run dev

# プレイテストURLを開く
# 例: https://www.reddit.com/r/jet-oni_dev?playtest=jet-oni
```

## テストケース

### 1. ゲーム作成テスト

#### 1.1 基本的なゲーム作成
- [ ] タイトル画面で「Create Game」をクリック
- [ ] ゲーム設定を選択（プレイヤー数、時間、ラウンド）
- [ ] 「Create」ボタンをクリック
- [ ] ロビー画面に遷移することを確認
- [ ] ホストとして表示されることを確認

**期待結果**: ゲームが正常に作成され、ロビー画面が表示される

#### 1.2 無効な設定でのゲーム作成
- [ ] プレイヤー数を3以下または21以上に設定
- [ ] エラーメッセージが表示されることを確認

**期待結果**: バリデーションエラーが表示される

### 2. ゲーム参加テスト

#### 2.1 基本的なゲーム参加
- [ ] 別のブラウザウィンドウを開く
- [ ] タイトル画面で「Join Game」をクリック
- [ ] 利用可能なゲームリストが表示されることを確認
- [ ] ゲームを選択して「Join」をクリック
- [ ] ロビー画面に遷移することを確認
- [ ] プレイヤーリストに自分が表示されることを確認

**期待結果**: ゲームに正常に参加し、ロビー画面が表示される

#### 2.2 満員のゲームへの参加
- [ ] 満員のゲームに参加を試みる
- [ ] エラーメッセージが表示されることを確認

**期待結果**: 「Game is full」エラーが表示される

#### 2.3 存在しないゲームへの参加
- [ ] 存在しないゲームIDで参加を試みる
- [ ] エラーメッセージが表示されることを確認

**期待結果**: 「Game not found」エラーが表示される

### 3. ロビーテスト

#### 3.1 プレイヤーリストの更新
- [ ] ホストのロビー画面を開く
- [ ] 別のブラウザで参加する
- [ ] ホストのプレイヤーリストが更新されることを確認
- [ ] 参加者のプレイヤーリストが表示されることを確認

**期待結果**: プレイヤーリストがリアルタイムで更新される

#### 3.2 カウントダウン
- [ ] 最大人数に達する
- [ ] 3秒カウントダウンが開始されることを確認
- [ ] カウントダウン後にゲームが開始されることを確認

**期待結果**: 自動的にゲームが開始される

#### 3.3 ホストによる早期開始
- [ ] ホストとしてロビーにいる
- [ ] 「Start Game」ボタンをクリック
- [ ] ゲームが即座に開始されることを確認

**期待結果**: ゲームが即座に開始される

### 4. ゲームプレイ同期テスト

#### 4.1 プレイヤー移動の同期
- [ ] 2つのブラウザでゲームを開始
- [ ] 一方のブラウザでプレイヤーを移動
- [ ] もう一方のブラウザで移動が反映されることを確認
- [ ] 移動がスムーズであることを確認（補間）

**期待結果**: プレイヤーの移動が両方のブラウザで同期される

#### 4.2 ジェットパックの同期
- [ ] 一方のブラウザでジェットパックを使用
- [ ] もう一方のブラウザでジェットパックエフェクトが表示されることを確認

**期待結果**: ジェットパック使用が同期される

#### 4.3 ダッシュの同期
- [ ] 一方のブラウザでダッシュを使用
- [ ] もう一方のブラウザでダッシュエフェクトが表示されることを確認

**期待結果**: ダッシュ使用が同期される

#### 4.4 ONI状態の同期
- [ ] ONIプレイヤーが赤く表示されることを確認
- [ ] 両方のブラウザで同じプレイヤーがONIとして表示されることを確認

**期待結果**: ONI状態が正しく同期される

#### 4.5 タグの同期
- [ ] ONIプレイヤーがランナーにタッチ
- [ ] タグされたプレイヤーがONIになることを確認
- [ ] 両方のブラウザで状態が更新されることを確認

**期待結果**: タグイベントが正しく同期される

### 5. エラーハンドリングテスト

#### 5.1 ネットワーク切断
- [ ] ゲームプレイ中にネットワークを切断
- [ ] 接続状態インジケーターが「切断」を表示することを確認
- [ ] ネットワークを再接続
- [ ] 自動的に再接続されることを確認

**期待結果**: ネットワーク切断が検出され、再接続される

#### 5.2 サーバーエラー
- [ ] サーバーを停止
- [ ] エラーメッセージが表示されることを確認
- [ ] リトライが試行されることを確認

**期待結果**: エラーが適切に処理される

#### 5.3 クライアント切断
- [ ] 一方のブラウザを閉じる
- [ ] もう一方のブラウザで切断が検出されることを確認
- [ ] 切断されたプレイヤーがAIに置き換えられることを確認

**期待結果**: 切断されたプレイヤーがAIに置き換えられる

### 6. パフォーマンステスト

#### 6.1 複数プレイヤー
- [ ] 4人でゲームをプレイ
- [ ] FPSが30以上を維持することを確認
- [ ] レイテンシが200ms以下であることを確認

**期待結果**: スムーズなゲームプレイが維持される

#### 6.2 最大プレイヤー数
- [ ] 20人でゲームをプレイ（AIを含む）
- [ ] FPSが30以上を維持することを確認
- [ ] レイテンシが200ms以下であることを確認

**期待結果**: 最大人数でもスムーズなゲームプレイが維持される

#### 6.3 長時間プレイ
- [ ] 5分間ゲームをプレイ
- [ ] メモリリークがないことを確認
- [ ] パフォーマンスが低下しないことを確認

**期待結果**: 長時間プレイでもパフォーマンスが維持される

### 7. ゲーム終了テスト

#### 7.1 タイマー終了
- [ ] タイマーが0になるまでプレイ
- [ ] ゲームが自動的に終了することを確認
- [ ] 結果画面が表示されることを確認
- [ ] 勝者が正しく表示されることを確認

**期待結果**: ゲームが正常に終了し、結果が表示される

#### 7.2 全員タグされた
- [ ] 全てのランナーがタグされる
- [ ] ゲームが自動的に終了することを確認
- [ ] 結果画面が表示されることを確認

**期待結果**: ゲームが正常に終了し、結果が表示される

## テスト実行手順

### 手動テスト
1. `npm run dev`で開発サーバーを起動
2. プレイテストURLを複数のブラウザで開く
3. 上記のテストケースを順番に実行
4. 各テストケースの結果を記録

### 自動テスト（オプション）
```bash
# E2Eテストを実行（未実装）
npm run test:e2e
```

## テスト結果の記録

### テスト実行日時
- 日時: _______________
- 実行者: _______________
- 環境: _______________

### テスト結果サマリー
- 合格: ___ / ___
- 不合格: ___ / ___
- スキップ: ___ / ___

### 発見された問題
1. _______________
2. _______________
3. _______________

### 改善提案
1. _______________
2. _______________
3. _______________

## 次のステップ

テストが完了したら:
1. 発見された問題を修正
2. 再テストを実施
3. タスク12（ドキュメントとデプロイ）に進む
